

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Lab 4: Advanced Wrangling with Pandas &#8212; Python Programming for Data Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Lab 3: Introduction to NumPy and Pandas" href="../lab3/lab3.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/511_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python Programming for Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Python Programming for Data Science
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture1-basics.html">
   Lecture 1: Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture2-loops-functions.html">
   Lecture 2: Loops &amp; Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture3-tests-classes.html">
   Lecture 3: Unit Tests &amp; Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture4-style-scripts-imports.html">
   Lecture 4: Style Guides, Scripts, Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture5-numpy.html">
   Lecture 5: Part 1 - Introduction to NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture5-numpy-addendum.html">
   Lecture 5: Part 2 - NumPy Implementation Details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture6-pandas.html">
   Lecture 6: Introduction to Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture7-wrangling-basics.html">
   Lecture 7: Basic Data Wrangling With Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture8-wrangling-advanced.html">
   Lecture 8: Advanced Data Wrangling With Pandas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lab Assignments
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../lab1/lab1.html">
   Lab 1: Python Basics, Loops &amp; Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lab2/lab2.html">
   Lab 2: Tests, Classes, Style &amp; Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lab3/lab3.html">
   Lab 3: Introduction to NumPy and Pandas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lab 4: Advanced Wrangling with Pandas
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Tomas Beuzen, MDS 2020<br>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lab-assignments/lab4/lab4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/TomasBeuzen/python-programming-for-data-science/master?urlpath=tree/lab-assignments/lab4/lab4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/TomasBeuzen/python-programming-for-data-science/blob/master/lab-assignments/lab4/lab4.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-1-dirty-gapminder">
   Exercise 1: Dirty Gapminder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-2-getting-sandy-with-pandas">
   Exercise 2: Getting Sandy with Pandas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-3-life-s-a-beach">
   Exercise 3: Life‚Äôs a Beach
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-4-time-for-some-science">
   Exercise 4: Time for Some Science
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     4.1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     4.2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     4.3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     4.4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     4.5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     4.6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-exercise-5-plotting">
   (OPTIONAL) Exercise 5: Plotting
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><img alt="" src="../../_images/511_banner4.png" /></p>
<div class="section" id="lab-4-advanced-wrangling-with-pandas">
<h1>Lab 4: Advanced Wrangling with Pandas<a class="headerlink" href="#lab-4-advanced-wrangling-with-pandas" title="Permalink to this headline">¬∂</a></h1>
<p><strong>Tomas Beuzen, September 2020</strong></p>
<p>In this lab, you‚Äôll complete various wrangling exercises using Pandas. I‚Äôll also be teaching you a little coastal science along the way!</p>
<p><img alt="" src="../../_images/beach.png" /></p>
<h2>Table of Contents<span class="tocSkip"></span></h2>
<div class="toc"><ul class="toc-item"><li><span><a href="#exercise-1-dirty-gapminder" data-toc-modified-id="Exercise-1:-Dirty-Gapminder-2">Exercise 1: Dirty Gapminder</a></span></li><li><span><a href="#exercise-2-getting-sandy-with-pandas" data-toc-modified-id="Exercise-2:-Getting-Sandy-with-Pandas-3">Exercise 2: Getting Sandy with Pandas</a></span></li><li><span><a href="#exercise-3-life's-a-beach" data-toc-modified-id="Exercise-3:-Life's-a-Beach-4">Exercise 3: Life's a Beach</a></span></li><li><span><a href="#exercise-4-time-for-some-science" data-toc-modified-id="Exercise-4:-Time-for-Some-Science-5">Exercise 4: Time for Some Science</a></span></li><li><span><a href="#optional-exercise-5-plotting" data-toc-modified-id="(OPTIONAL)-Exercise-5:-Plotting-6">(OPTIONAL) Exercise 5: Plotting</a></span></li><li><span><a href="#submission-to-canvas" data-toc-modified-id="Submission-to-Canvas-7">Submission to Canvas</a></span></li></ul></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                     <span class="s1">&#39;axes.labelweight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-1-dirty-gapminder">
<h2>Exercise 1: Dirty Gapminder<a class="headerlink" href="#exercise-1-dirty-gapminder" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>rubric={autograde:4}</p>
<p>In Lab 3 you performed some basic Pandas operations on the Gapminder dataset. However, this dataset was given to you clean and shiny and ready-to-go. In the real world, that‚Äôs rarely the case, and in this exercise you‚Äôll have to clean up a ‚Äúdirty‚Äù version of the Gapminder dataset. For your interest, <a class="reference external" href="http://www.opiniomics.org/biologists-this-is-why-bioinformaticians-hate-you/">here</a> is an article on why data cleaning is important and how extremely frustrating it can be.</p>
<p>Your goal is to load in ‚Äúdirty gapminder‚Äù as a dataframe called <code class="docutils literal notranslate"><span class="pre">dirty</span></code> and ‚Äúclean gapminder‚Äù as a dataframe called <code class="docutils literal notranslate"><span class="pre">clean</span></code>, and wrangle <code class="docutils literal notranslate"><span class="pre">dirty</span></code> until it is the same as <code class="docutils literal notranslate"><span class="pre">clean</span></code>:</p>
<ul class="simple">
<li><p>Dirty gapminder: <a class="reference external" href="https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear_dirty.txt">https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear_dirty.txt</a></p></li>
<li><p>Clean gapminder: <a class="reference external" href="https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear.txt">https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear.txt</a></p></li>
</ul>
<p>A test has been provided to check that <code class="docutils literal notranslate"><span class="pre">dirty</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">clean</span></code>. Things you might want to do to clean up <code class="docutils literal notranslate"><span class="pre">dirty</span></code>:</p>
<ul class="simple">
<li><p>Check that <code class="docutils literal notranslate"><span class="pre">dirty</span></code> and <code class="docutils literal notranslate"><span class="pre">clean</span></code> have the same columns;</p></li>
<li><p>Check if there is any missing data, if there is missing data (NaNs or empty strings) fill them with sensible values;</p></li>
<li><p>Check for things like capitalization, spelling, grammar, etc;</p></li>
<li><p>there may be entries that appear to have the exact same spelling and capitalization in both <code class="docutils literal notranslate"><span class="pre">dirty</span></code> and <code class="docutils literal notranslate"><span class="pre">clean</span></code>, but still don‚Äôt match‚Ä¶ Extra whitespace is often a frustrating (and invisible) problem when wrangling text data. You can use <code class="docutils literal notranslate"><span class="pre">Series.str.strip()</span></code> to trim any additional unwanted whitespace around a string.</p></li>
<li><p>At any time, you can check which rows in <code class="docutils literal notranslate"><span class="pre">dirty</span></code> are not equal to <code class="docutils literal notranslate"><span class="pre">clean</span></code> using something like: <code class="docutils literal notranslate"><span class="pre">dirty[dirty.ne(clean).any(axis=1)]</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_dirty</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear_dirty.txt&#39;</span>
<span class="n">url_clean</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/STAT545-UBC/STAT545-UBC.github.io/master/gapminderDataFiveYear.txt&#39;</span>
<span class="n">dirty</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">clean</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-2-getting-sandy-with-pandas">
<h2>Exercise 2: Getting Sandy with Pandas<a class="headerlink" href="#exercise-2-getting-sandy-with-pandas" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>rubric={autograde:4}</p>
<p>During my undergrad and PhD I led a beach survey program of one of the local beaches in Sydney, Australia called Narrabeen Beach. The survey program started in the 1970‚Äôs and has continued to the present day. All the data is available at a website hosted by the lab I did my PhD at: <a class="reference external" href="http://narrabeen.wrl.unsw.edu.au/explore_data/time_series/">http://narrabeen.wrl.unsw.edu.au/explore_data/time_series/</a>. In the next few exercises we‚Äôre going to download, wrangle, and explore this dataset.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><img alt="" src="../../_images/narrabeen.jpg" /></p></td>
<td><p><img alt="" src="../../_images/survey.jpg" /></p></td>
</tr>
</tbody>
</table>
<p>The survey program aimed to measure the width of the beach every few weeks. There were five locations that we would measure along the beach, from location 1 at the north end of the beach, to location 5 at the south end:</p>
<p><img alt="" src="../../_images/survey_locations.jpg" /></p>
<p>Below I‚Äôve provided you with a function <code class="docutils literal notranslate"><span class="pre">get_beach_data()</span></code> that ‚Äúscrapes‚Äù the <a class="reference external" href="http://narrabeen.wrl.unsw.edu.au">http://narrabeen.wrl.unsw.edu.au</a> website‚Äôs data using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library (you‚Äôll learn more about web scraping in DSCI 525). The function returns a list of tuples containing the date of a survey and the width of the beach on that date, for the given <code class="docutils literal notranslate"><span class="pre">survey_location</span></code> (1, 2, 3, 4, or 5), e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">get_beach_data</span><span class="p">(</span><span class="n">survey_location</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;1976-04-27&#39;</span><span class="p">,</span> <span class="s1">&#39;78.5&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-05-10&#39;</span><span class="p">,</span> <span class="s1">&#39;65.1&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-05-18&#39;</span><span class="p">,</span> <span class="s1">&#39;72.9&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-05-25&#39;</span><span class="p">,</span> <span class="s1">&#39;76.0&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-06-02&#39;</span><span class="p">,</span> <span class="s1">&#39;83.4&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-06-16&#39;</span><span class="p">,</span> <span class="s1">&#39;67.7&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-06-18&#39;</span><span class="p">,</span> <span class="s1">&#39;74.5&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;1976-06-23&#39;</span><span class="p">,</span> <span class="s1">&#39;78.2&#39;</span><span class="p">),</span>
 <span class="o">...</span>
</pre></div>
</div>
<p><strong>Your Tasks</strong></p>
<hr>
<ol class="simple">
<li><p>Extract the data for each survey location (1, 2, 3, 4, 5) and store them in five separate Series with the Index of the Series being the datetime (hint: you‚Äôll need to convert the string dates to datetimes with <code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code>.</p></li>
<li><p>Merge all of the Series together in a single dataframe. <strong>Note that the Series are not all the same length</strong> (sometimes I forgot to measure a certain location üòÅ), so we want to do an ‚Äúinner‚Äù join on the index values between all the Series here (hint: <code class="docutils literal notranslate"><span class="pre">df.merge()</span></code> would work just fine here, but when we want to join more than two series with a simple ‚Äúinner‚Äù join on the indexes, <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> might be your friend‚Ä¶ check out the docstring). Your final dataframe should be called <code class="docutils literal notranslate"><span class="pre">beach_df</span></code> and should look like this (note that the datetimes have been set as the index):</p></li>
</ol>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>location_1</p></th>
<th class="head"><p>location_2</p></th>
<th class="head"><p>location_3</p></th>
<th class="head"><p>location_4</p></th>
<th class="head"><p>location_5</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1976-04-27</strong></p></td>
<td><p>78.5</p></td>
<td><p>59.7</p></td>
<td><p>44.7</p></td>
<td><p>16.2</p></td>
<td><p>63.5</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1976-05-10</strong></p></td>
<td><p>65.1</p></td>
<td><p>60.7</p></td>
<td><p>61.6</p></td>
<td><p>15.0</p></td>
<td><p>65.8</p></td>
</tr>
<tr class="row-even"><td><p><strong>1976-05-18</strong></p></td>
<td><p>72.9</p></td>
<td><p>67.0</p></td>
<td><p>68.6</p></td>
<td><p>23.8</p></td>
<td><p>64.3</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1976-05-25</strong></p></td>
<td><p>76.0</p></td>
<td><p>70.3</p></td>
<td><p>67.6</p></td>
<td><p>21.8</p></td>
<td><p>44.5</p></td>
</tr>
<tr class="row-even"><td><p><strong>1976-06-02</strong></p></td>
<td><p>83.4</p></td>
<td><p>79.5</p></td>
<td><p>79.8</p></td>
<td><p>24.5</p></td>
<td><p>57.1</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>The next few questions of this lab rely on this dataframe so make sure you pass the autograder before proceeding. If you are unable to pass the autograder, I‚Äôve saved a version of the dataframe in the data folder of this directory. When you get to Exercise 3, you may just read that in with <code class="docutils literal notranslate"><span class="pre">pd.read_csv('data/beach_data.csv',</span> <span class="pre">index_col=0,</span> <span class="pre">parse_dates=True)</span></code>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_beach_data</span><span class="p">(</span><span class="n">survey_location</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">survey_location</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;survey_location should be an integer 1, 2, 3, 4, or 5.&quot;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://narrabeen.wrl.unsw.edu.au/explore_data/time_series/&quot;</span>
    <span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">cookies</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;csrfmiddlewaretoken&quot;</span><span class="p">:</span> <span class="n">cookies</span><span class="p">[</span><span class="s2">&quot;csrftoken&quot;</span><span class="p">],</span>
            <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">survey_location</span><span class="p">),</span>
            <span class="s2">&quot;startDate&quot;</span><span class="p">:</span> <span class="s2">&quot;27/04/1976&quot;</span><span class="p">,</span>
            <span class="s2">&quot;endDate&quot;</span><span class="p">:</span> <span class="s2">&quot;26/08/2020&quot;</span><span class="p">,</span>
            <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;new Date\(&quot;(.*)&quot;\)\.getTime\(\), (\d+.\d)&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beach_df</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-3-life-s-a-beach">
<h2>Exercise 3: Life‚Äôs a Beach<a class="headerlink" href="#exercise-3-life-s-a-beach" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>rubric={accuracy:4,efficiency:2}</p>
<p>In Exercise 2 you may have noticed that the frequency of the data you just collected is on the order of a few days to a few weeks (it‚Äôs irregularly spaced). This can make it difficult to extract patterns from the data. One way to deal with this is to aggregating our time series to a regular interval (e.g., from irregular daily data -&gt; monthly data). That‚Äôs what we‚Äôll be doing in this question.</p>
<blockquote>
<div><p>If you were unable to wrangle the data and pass the autograder in Exercise 2, I‚Äôve saved a version of the <code class="docutils literal notranslate"><span class="pre">beach_df</span></code> in the data folder of this directory which you may read in with <code class="docutils literal notranslate"><span class="pre">pd.read_csv('data/beach_data.csv',</span> <span class="pre">index_col=0)</span></code> to answer this question.</p>
</div></blockquote>
<p><strong>Your Tasks</strong></p>
<hr>
<ol class="simple">
<li><p>First ‚Äúde-mean‚Äù each column by subtracting the mean of each column from the column - this will help us see if a location on the beach is narrower (negative numbers) or wider (positive numbers) than the average at a certain time.</p></li>
<li><p>Resample <code class="docutils literal notranslate"><span class="pre">beach_df</span></code> from the previous question to a monthly interval with the mean as the aggregation function (hint: <code class="docutils literal notranslate"><span class="pre">.resample()</span></code>) and change the index of the dataframe to a Pandas <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code> (hint: take a look at the arguments of <code class="docutils literal notranslate"><span class="pre">.resample()</span></code>‚Ä¶). Finally, remove all entries prior to 1980 (the accuracy of these measurements was not great!) (hint: remember we can very easily index datetimes with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#partial-string-indexing">partial string matching</a>).</p></li>
<li><p>Finally, melt the dataframe into tidy format, your final <code class="docutils literal notranslate"><span class="pre">beach_df</span></code> should look something like this:</p></li>
</ol>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>location</p></th>
<th class="head"><p>width</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1980-01</strong></p></td>
<td><p>location_1</p></td>
<td><p>4.356982</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1980-02</strong></p></td>
<td><p>location_1</p></td>
<td><p>3.856982</p></td>
</tr>
<tr class="row-even"><td><p><strong>1980-03</strong></p></td>
<td><p>location_1</p></td>
<td><p>0.156982</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1980-04</strong></p></td>
<td><p>location_1</p></td>
<td><p>4.856982</p></td>
</tr>
<tr class="row-even"><td><p><strong>1980-05</strong></p></td>
<td><p>location_1</p></td>
<td><p>-14.343018</p></td>
</tr>
<tr class="row-odd"><td><p><strong>‚Ä¶</strong></p></td>
<td><p>‚Ä¶</p></td>
<td><p>‚Ä¶</p></td>
</tr>
<tr class="row-even"><td><p><strong>2019-07</strong></p></td>
<td><p>location_5</p></td>
<td><p>-7.042108</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2019-08</strong></p></td>
<td><p>location_5</p></td>
<td><p>-6.225441</p></td>
</tr>
<tr class="row-even"><td><p><strong>2019-09</strong></p></td>
<td><p>location_5</p></td>
<td><p>-14.425441</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2019-10</strong></p></td>
<td><p>location_5</p></td>
<td><p>-15.125441</p></td>
</tr>
<tr class="row-even"><td><p><strong>2019-11</strong></p></td>
<td><p>location_5</p></td>
<td><p>-15.542108</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beach_df</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-4-time-for-some-science">
<h2>Exercise 4: Time for Some Science<a class="headerlink" href="#exercise-4-time-for-some-science" title="Permalink to this headline">¬∂</a></h2>
<hr><p><img alt="" src="../../_images/science.png" /></p>
<p>Nice job! In the last few exercises you wrangled a messy dataset into a nice tidy format! In this exercise you‚Äôll get to explore this dataset and I‚Äôll teach you some coastal science along the way. You can use any of the techniques you‚Äôve learned to answer these exercises.</p>
<div class="section" id="id1">
<h3>4.1<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>Which survey location (1, 2, 3, 4, or 5) has the greatest variability in measured beach widths? (You may leave your answer as the output of a dataframe operation, you don‚Äôt have to write ‚Äúlocation X‚Äù).</p>
<blockquote>
<div><p><strong>Science</strong>: Waves are a key factor that shape beaches. Large waves erode (narrow) beaches and small wave accrete (widen) beaches. Waves hitting the southeast coast of Australia predominantly come from the south, meaning that it‚Äôs usually the northern end of beaches on this coastline that are most affected by waves, i.e., have the most variability.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>4.2<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>Which survey location (1, 2, 3, 4, or 5) experienced the greatest erosion in the time series (i.e., the largest negative number)? (You may leave your answer as the output of a dataframe operation, you don‚Äôt have to write ‚Äúlocation X‚Äù)</p>
<blockquote>
<div><p><strong>Science</strong>: sometimes the southeast Australian coast gets hit by tropical cyclones which come directly from the east and generate huge waves. As a result, sections of beaches that are east-facing typically experience the greatest erosion.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>4.3<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>Of the four seasons (summer, autumn, spring, winter), which season is the beach, on average, the narrowest? Remember that the seasons in Australia are opposite to Canada, e.g., December-February is summer and June-August is winter (<em>hint</em>: decompose the datetime index to create a ‚Äúmonth‚Äù column and use <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>). (You may leave your answer as the output of a dataframe operation, you don‚Äôt have to write ‚Äúseason X‚Äù).</p>
<blockquote>
<div><p><strong>Science</strong>: the southeast coast of Australia experiences larger waves in the cooler winter months. That‚Äôs because, in winter, very cold air flows north from Antarctica and reacts with warmer air travelling south from the equator, generating large low-pressure (storm) systems that create big waves.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>4.4<a class="headerlink" href="#id4" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>Calculate the correlation between beach width observations at location 1 and location 5.</p>
<blockquote>
<div><p><strong>Science</strong>: one cool thing about embayed beaches like Narrabeen is that the amount of sand in the system is typically conserved. That means that if one part of the beach is getting narrower, another section is probably getting wider. This is most obvious at the extremes of the beach, location 1 and location 5 in our case. We can confirm this by calculating the correlation between observations of these two locations (it should be negative, which means that if one location is eroding/accreting, the other location is doing the opposite). (<em>hint</em>: there is a dataframe method that calculates correlation between columns).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h3>4.5<a class="headerlink" href="#id5" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>Perform a double ‚Äúgroupby‚Äù operation (group on two columns) to determine for which month <em>and</em> location the beach is <em>on average</em> the widest.</p>
<blockquote>
<div><p><strong>Science</strong>: this is a really interesting question! In the previous questions we learned that the northern-most beach location (location 1) is the most exposed to waves, that the biggest waves occur in winter, but that if one part of the beach is eroding (becoming narrower), then the opposite end is probably accreting (getting wider). So, we‚Äôd expect the answer here to be around the middle of the year (winter-ish time) and location 5 (opposite end of the beach to location 1).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>4.6<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h3>
<p>rubric={accuracy:1}</p>
<p>For how many months in our monthly, resampled time series spanning 1980 - 2019 is at least one observation for a location missing?</p>
<blockquote>
<div><p><strong>Science</strong>: No science here. Collecting field data is time-consuming work - luckily new technologies like satellite data, LIDAR, and cameras will make monitoring beaches much more reliable and consistent in the future.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="optional-exercise-5-plotting">
<h2>(OPTIONAL) Exercise 5: Plotting<a class="headerlink" href="#optional-exercise-5-plotting" title="Permalink to this headline">¬∂</a></h2>
<hr>
<p>rubric={accuracy:1}</p>
<p>In Exercise 4 we just learned that at Narrabeen Beach, there is a ‚Äúrotation effect‚Äù where if one end of the beach is getting narrower, often the other end is getting wider, and that this is most obvious at the extremes of the beach, location 1 and location 5. Your task here is to get visual confirmation of that rotation phenomenon by plotting the time series of observations for location 1 and location 5 on the same plot (<em>hint</em>: you should drop the NaN values in the time series before plotting).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your answer goes here.</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../../_images/congrats.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lab-assignments/lab4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../lab3/lab3.html" title="previous page">Lab 3: Introduction to NumPy and Pandas</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tomas Beuzen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>
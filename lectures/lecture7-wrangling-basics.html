

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Lecture 7: Basic Data Wrangling With Pandas &#8212; Python Programming for Data Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lecture 8: Advanced Data Wrangling With Pandas" href="lecture8-wrangling-advanced.html" />
    <link rel="prev" title="Lecture 6: Introduction to Pandas" href="lecture6-pandas.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/511_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python Programming for Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Python Programming for Data Science
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lecture1-basics.html">
   Lecture 1: Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture2-loops-functions.html">
   Lecture 2: Loops &amp; Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture3-tests-classes.html">
   Lecture 3: Unit Tests &amp; Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture4-style-scripts-imports.html">
   Lecture 4: Style Guides, Scripts, Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture5-numpy.html">
   Lecture 5: Part 1 - Introduction to NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture5-numpy-addendum.html">
   Lecture 5: Part 2 - NumPy Implementation Details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture6-pandas.html">
   Lecture 6: Introduction to Pandas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lecture 7: Basic Data Wrangling With Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture8-wrangling-advanced.html">
   Lecture 8: Advanced Data Wrangling With Pandas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lab Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../lab-assignments/lab1/lab1.html">
   Lab 1: Python Basics, Loops &amp; Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lab-assignments/lab2/lab2.html">
   Lab 2: Tests, Classes, Style &amp; Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lab-assignments/lab3/lab3.html">
   Lab 3: Introduction to NumPy and Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lab-assignments/lab4/lab4.html">
   Lab 4: Advanced Wrangling with Pandas
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Tomas Beuzen, MDS 2020<br>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/lecture7-wrangling-basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/TomasBeuzen/python-programming-for-data-science/master?urlpath=tree/lectures/lecture7-wrangling-basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/TomasBeuzen/python-programming-for-data-science/blob/master/lectures/lecture7-wrangling-basics.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-learning-objectives">
   Lecture Learning Objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataframe-characteristics">
   1. DataFrame Characteristics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#head-tail">
     Head/Tail
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataframe-summaries">
     DataFrame Summaries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#displaying-dataframes">
     Displaying DataFrames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#views-vs-copies">
     Views vs Copies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-dataframe-manipulations">
   2. Basic DataFrame Manipulations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#renaming-columns">
     Renaming Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#changing-the-index">
     Changing the Index
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-removing-columns">
     Adding/Removing Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-removing-rows">
     Adding/Removing Rows
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataframe-reshaping">
   3. DataFrame Reshaping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidy-data">
     Tidy Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#melt-and-pivot">
     Melt and Pivot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-multiple-dataframes">
   4. Working with Multiple DataFrames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sticking-dataframes-together-with-pd-concat">
     Sticking DataFrames Together with
     <code class="docutils literal notranslate">
      <span class="pre">
       pd.concat()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joining-dataframes-with-pd-merge">
     Joining DataFrames with
     <code class="docutils literal notranslate">
      <span class="pre">
       pd.merge()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-dataframe-operations">
   5. More DataFrame Operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-custom-functions">
     Applying Custom Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grouping">
     Grouping
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dealing-with-missing-values">
     Dealing with Missing Values
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><img alt="" src="../_images/511_banner.png" /></p>
<div class="section" id="lecture-7-basic-data-wrangling-with-pandas">
<h1>Lecture 7: Basic Data Wrangling With Pandas<a class="headerlink" href="#lecture-7-basic-data-wrangling-with-pandas" title="Permalink to this headline">¶</a></h1>
<p><strong>Tomas Beuzen, September 2020</strong></p>
<h2>Lecture Outline<span class="tocSkip"></span></h2>
<div class="toc"><ul class="toc-item"><li><span><a href="#lecture-learning-objectives" data-toc-modified-id="Lecture-Learning-Objectives-1">Lecture Learning Objectives</a></span></li><li><span><a href="#dataframe-characteristics" data-toc-modified-id="1.-DataFrame-Characteristics-2">1. DataFrame Characteristics</a></span></li><li><span><a href="#basic-dataframe-manipulations" data-toc-modified-id="2.-Basic-DataFrame-Manipulations-3">2. Basic DataFrame Manipulations</a></span></li><li><span><a href="#dataframe-reshaping" data-toc-modified-id="3.-DataFrame-Reshaping-4">3. DataFrame Reshaping</a></span></li><li><span><a href="#working-with-multiple-dataframes" data-toc-modified-id="4.-Working-with-Multiple-DataFrames-5">4. Working with Multiple DataFrames</a></span></li><li><span><a href="#more-dataframe-operations" data-toc-modified-id="5.-More-DataFrame-Operations-6">5. More DataFrame Operations</a></span></li></ul></div><div class="section" id="lecture-learning-objectives">
<h2>Lecture Learning Objectives<a class="headerlink" href="#lecture-learning-objectives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Inspect a dataframe with <code class="docutils literal notranslate"><span class="pre">df.head()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.info()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.describe()</span></code>.</p></li>
<li><p>Obtain dataframe summaries with <code class="docutils literal notranslate"><span class="pre">df.info()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.describe()</span></code>.</p></li>
<li><p>Manipulate how a dataframe displays in Jupyter by modifying Pandas configuration options such as <code class="docutils literal notranslate"><span class="pre">pd.set_option(&quot;display.max_rows&quot;,</span> <span class="pre">n)</span></code>.</p></li>
<li><p>Rename columns of a dataframe using the <code class="docutils literal notranslate"><span class="pre">df.rename()</span></code> function or by accessing the <code class="docutils literal notranslate"><span class="pre">df.columns</span></code> attribute.</p></li>
<li><p>Modify the index name and index values of a dataframe using <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code>, <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> , <code class="docutils literal notranslate"><span class="pre">df.index.name</span></code>, <code class="docutils literal notranslate"><span class="pre">.index</span></code>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">df.melt()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.pivot()</span></code> to reshape dataframes, specifically to make tidy dataframes.</p></li>
<li><p>Combine dataframes using <code class="docutils literal notranslate"><span class="pre">df.merge()</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> and know when to use these different methods.</p></li>
<li><p>Apply functions to a dataframe <code class="docutils literal notranslate"><span class="pre">df.apply()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.applymap()</span></code></p></li>
<li><p>Perform grouping and aggregating operations using <code class="docutils literal notranslate"><span class="pre">df.groupby()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.agg()</span></code>.</p></li>
<li><p>Perform aggregating methods on grouped or ungrouped objects such as finding the minimum, maximum and sum of values in a dataframe using <code class="docutils literal notranslate"><span class="pre">df.agg()</span></code>.</p></li>
<li><p>Remove or fill missing values in a dataframe with <code class="docutils literal notranslate"><span class="pre">df.dropna()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.fillna()</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dataframe-characteristics">
<h2>1. DataFrame Characteristics<a class="headerlink" href="#dataframe-characteristics" title="Permalink to this headline">¶</a></h2>
<hr><ul class="simple">
<li><p>Last lecture we looked at how we can create dataframes</p></li>
<li><p>Let’s now look at some helpful ways we can view our dataframe</p></li>
</ul>
<div class="section" id="head-tail">
<h3>Head/Tail<a class="headerlink" href="#head-tail" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">.tail()</span></code> methods allow you to view the top/bottom <em>n</em> (default 5) rows of a dataframe</p></li>
<li><p>Let’s load in the cycling data set from last lecture and try them out:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cycling_data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The default return value is 5 rows, but we can pass in any number we like</p></li>
<li><p>For example, let’s take a look at the top 10 rows:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16 Sep 2019, 13:57:48</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2272</td>
      <td>12.45</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17 Sep 2019, 13:43:34</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2285</td>
      <td>12.60</td>
      <td>Raining</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18 Sep 2019, 13:49:53</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2903</td>
      <td>14.57</td>
      <td>Raining today</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Or the bottom 5 rows:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="dataframe-summaries">
<h3>DataFrame Summaries<a class="headerlink" href="#dataframe-summaries" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Three very helpful attributes/functions for getting high-level summaries of your dataframe are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.shape</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.info()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.describe()</span></code></p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.shape</span></code> is just like the ndarray attribute we’ve seen previously</p></li>
<li><p>It gives the shape (rows, cols) of your dataframe:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(33, 6)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.info()</span></code> prints information about the dataframe itself, such as dtypes, memory usages, non-null values, etc:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 33 entries, 0 to 32
Data columns (total 6 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      33 non-null     object 
 1   Name      33 non-null     object 
 2   Type      33 non-null     object 
 3   Time      33 non-null     int64  
 4   Distance  31 non-null     float64
 5   Comments  33 non-null     object 
dtypes: float64(1), int64(1), object(4)
memory usage: 1.7+ KB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.describe()</span></code> provides summary statistics of the values within a dataframe:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3512.787879</td>
      <td>12.667419</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8003.309233</td>
      <td>0.428618</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1712.000000</td>
      <td>11.790000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1863.000000</td>
      <td>12.480000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2118.000000</td>
      <td>12.620000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2285.000000</td>
      <td>12.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>48062.000000</td>
      <td>14.570000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>By default, <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> only print summaries of numeric features</p></li>
<li><p>We can force it to give summaries on all features using the argument <code class="docutils literal notranslate"><span class="pre">include='all'</span></code> (although they may not make sense!):</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33</td>
      <td>33</td>
      <td>33</td>
      <td>33.000000</td>
      <td>31.000000</td>
      <td>33</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>33</td>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25</td>
    </tr>
    <tr>
      <th>top</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>17</td>
      <td>33</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3512.787879</td>
      <td>12.667419</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8003.309233</td>
      <td>0.428618</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1712.000000</td>
      <td>11.790000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1863.000000</td>
      <td>12.480000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2118.000000</td>
      <td>12.620000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2285.000000</td>
      <td>12.750000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48062.000000</td>
      <td>14.570000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="displaying-dataframes">
<h3>Displaying DataFrames<a class="headerlink" href="#displaying-dataframes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Displaying your dataframes effectively can be an important part of your workflow</p></li>
<li><p>If a dataframe has more than 60 rows, Pandas will only display the first 5 and last 5 rows:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.479080</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.960817</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.173330</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.493497</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.282814</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>0.902599</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0.147490</td>
    </tr>
    <tr>
      <th>97</th>
      <td>0.618611</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0.649477</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0.844713</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 1 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>For dataframes of less than 60 rows, Pandas will print the whole dataframe</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16 Sep 2019, 13:57:48</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2272</td>
      <td>12.45</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17 Sep 2019, 13:43:34</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2285</td>
      <td>12.60</td>
      <td>Raining</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18 Sep 2019, 13:49:53</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2903</td>
      <td>14.57</td>
      <td>Raining today</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>11</th>
      <td>19 Sep 2019, 13:52:09</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2090</td>
      <td>12.59</td>
      <td>Getting colder which is nice</td>
    </tr>
    <tr>
      <th>12</th>
      <td>20 Sep 2019, 01:02:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2961</td>
      <td>12.81</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>13</th>
      <td>23 Sep 2019, 13:50:41</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2462</td>
      <td>12.68</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24 Sep 2019, 00:35:42</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2076</td>
      <td>12.47</td>
      <td>Oiled chain, bike feels smooth</td>
    </tr>
    <tr>
      <th>15</th>
      <td>24 Sep 2019, 13:41:24</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2321</td>
      <td>12.68</td>
      <td>Bike feeling much smoother</td>
    </tr>
    <tr>
      <th>16</th>
      <td>25 Sep 2019, 00:07:21</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1775</td>
      <td>12.10</td>
      <td>Feeling really tired</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25 Sep 2019, 13:35:41</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2124</td>
      <td>12.65</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26 Sep 2019, 00:13:33</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1860</td>
      <td>12.52</td>
      <td>raining</td>
    </tr>
    <tr>
      <th>19</th>
      <td>26 Sep 2019, 13:42:43</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2350</td>
      <td>12.91</td>
      <td>Detour around trucks at Jericho</td>
    </tr>
    <tr>
      <th>20</th>
      <td>27 Sep 2019, 01:00:18</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712</td>
      <td>12.47</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>21</th>
      <td>30 Sep 2019, 13:53:52</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2118</td>
      <td>12.71</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1 Oct 2019, 13:45:55</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2222</td>
      <td>12.82</td>
      <td>Beautiful morning! Feeling fit</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2 Oct 2019, 13:46:06</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2134</td>
      <td>13.06</td>
      <td>Bit tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3 Oct 2019, 13:47:36</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2182</td>
      <td>12.68</td>
      <td>Wet road</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>I find the 60 row threshold to be a little too much, I prefer something more like 20</p></li>
<li><p>You can change the setting using <code class="docutils literal notranslate"><span class="pre">pd.set_option(&quot;display.max_rows&quot;,</span> <span class="pre">20)</span></code> so that anything with more than 20 rows will be summarised by the first and last 5 rows as before:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>There are also other display options you can change, such as how many columns are shown, how numbers are formatted, etc.</p></li>
<li><p>See the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html#options-and-settings">official documentation</a> for more</p></li>
<li><p>Another display option I will point out is that Pandas allows you to style your tables, for example by highlighting negative values, or adding conditional colour maps to your dataframe</p></li>
<li><p>Below I’ll style values based on their value ranging from negative (purple) to postive (yellow) but you can see the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html#Styling">styling documentation</a> for more examples</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;row_</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;feature_</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">test</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
#T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col0,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col2,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col1,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col3,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col4{
            background-color:  #0d0887;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col1{
            background-color:  #330597;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col3{
            background-color:  #f0804e;
            color:  #000000;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col4,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col3,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col0,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col2,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col1,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col3{
            background-color:  #f0f921;
            color:  #000000;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col0{
            background-color:  #cb4679;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col1{
            background-color:  #a11b9b;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col2{
            background-color:  #4903a0;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col4,#T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col3{
            background-color:  #f79342;
            color:  #000000;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col1{
            background-color:  #6900a8;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col4{
            background-color:  #b7318a;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col0{
            background-color:  #f9983e;
            color:  #000000;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col2{
            background-color:  #b52f8c;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col4{
            background-color:  #8a09a5;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col0{
            background-color:  #9c179e;
            color:  #f1f1f1;
        }#T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col2{
            background-color:  #6400a7;
            color:  #f1f1f1;
        }</style><table id="T_398c8f62_074f_11eb_86d6_a683e74d2b66" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >feature_0</th>        <th class="col_heading level0 col1" >feature_1</th>        <th class="col_heading level0 col2" >feature_2</th>        <th class="col_heading level0 col3" >feature_3</th>        <th class="col_heading level0 col4" >feature_4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_398c8f62_074f_11eb_86d6_a683e74d2b66level0_row0" class="row_heading level0 row0" >row_0</th>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col0" class="data row0 col0" >-1.133989</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col1" class="data row0 col1" >-0.617645</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col2" class="data row0 col2" >-0.905044</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col3" class="data row0 col3" >0.048443</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row0_col4" class="data row0 col4" >0.417325</td>
            </tr>
            <tr>
                        <th id="T_398c8f62_074f_11eb_86d6_a683e74d2b66level0_row1" class="row_heading level0 row1" >row_1</th>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col0" class="data row1 col0" >-0.209779</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col1" class="data row1 col1" >0.086924</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col2" class="data row1 col2" >-0.651659</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col3" class="data row1 col3" >0.370691</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row1_col4" class="data row1 col4" >-0.057885</td>
            </tr>
            <tr>
                        <th id="T_398c8f62_074f_11eb_86d6_a683e74d2b66level0_row2" class="row_heading level0 row2" >row_2</th>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col0" class="data row2 col0" >0.721428</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col1" class="data row2 col1" >-0.297673</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col2" class="data row2 col2" >1.215956</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col3" class="data row2 col3" >0.107655</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row2_col4" class="data row2 col4" >-0.658408</td>
            </tr>
            <tr>
                        <th id="T_398c8f62_074f_11eb_86d6_a683e74d2b66level0_row3" class="row_heading level0 row3" >row_3</th>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col0" class="data row3 col0" >0.272190</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col1" class="data row3 col1" >1.711102</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col2" class="data row3 col2" >-0.023139</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col3" class="data row3 col3" >0.372863</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row3_col4" class="data row3 col4" >-0.918511</td>
            </tr>
            <tr>
                        <th id="T_398c8f62_074f_11eb_86d6_a683e74d2b66level0_row4" class="row_heading level0 row4" >row_4</th>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col0" class="data row4 col0" >-0.515310</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col1" class="data row4 col1" >-0.790757</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col2" class="data row4 col2" >-0.515313</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col3" class="data row4 col3" >-0.666606</td>
                        <td id="T_398c8f62_074f_11eb_86d6_a683e74d2b66row4_col4" class="data row4 col4" >-1.450039</td>
            </tr>
    </tbody></table></div></div>
</div>
</div>
<div class="section" id="views-vs-copies">
<h3>Views vs Copies<a class="headerlink" href="#views-vs-copies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>In previous lectures we’ve discussed views (“looking” at a part of an existing object) and copies (making a new copy of the object in memory)</p></li>
<li><p>These things get a little abstract with Pandas and “…it’s very hard to predict whether it will return a view or a copy” (that’s a quote straight <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy">from a dedicated section in the Pandas documentation</a>)</p></li>
<li><p>Basically, it depends on the operation you are trying to perform, your dataframe’s structure and the memory layout of the underlying array</p></li>
<li><p>But don’t worry, let me tell you all you need to know</p></li>
<li><p>Firstly, the most common warning you’ll encounter in Pandas is the <code class="docutils literal notranslate"><span class="pre">SettingWithCopy</span></code>, Pandas raises it as a warning that you might not be doing what you think you’re doing</p></li>
<li><p>Let’s see an example. You may recall there is one outlier <code class="docutils literal notranslate"><span class="pre">Time</span></code> in our dataframe:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Imagine we wanted to change this to <code class="docutils literal notranslate"><span class="pre">2000</span></code></p></li>
<li><p>You’d probably do the following:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Ah, there’s that warning</p></li>
<li><p>Did our dataframe get changed?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>No it didn’t, even though you probably thought it did</p></li>
<li><p>What happened above is that <code class="docutils literal notranslate"><span class="pre">df[df['Time']</span> <span class="pre">&gt;</span> <span class="pre">4000]</span></code> was executed first and returned a copy of the dataframe, we can confirm by using <code class="docutils literal notranslate"><span class="pre">id()</span></code>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The id of the original dataframe is: </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; The id of the indexed dataframe is: </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The id of the original dataframe is: 4531610320
 The id of the indexed dataframe is: 5915539088
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We then tried to set a value on this new object by appending <code class="docutils literal notranslate"><span class="pre">['Time']</span> <span class="pre">=</span> <span class="pre">2000</span></code></p></li>
<li><p>Pandas is warning us that we are doing that operation on a copy of the original dataframe, which is probably not what we want</p></li>
<li><p>To fix this, you need to index in a single go, using <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> for example:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>No error this time! And let’s confirm the change:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The second thing you need to know is that if you’re ever in doubt about whether something is a view or a copy, you can just use the <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> method to force a copy of a dataframe</p></li>
<li><p>Just like this:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>That way, your guaranteed a copy that you can modify as you wish</p></li>
</ul>
</div>
</div>
<div class="section" id="basic-dataframe-manipulations">
<h2>2. Basic DataFrame Manipulations<a class="headerlink" href="#basic-dataframe-manipulations" title="Permalink to this headline">¶</a></h2>
<hr><div class="section" id="renaming-columns">
<h3>Renaming Columns<a class="headerlink" href="#renaming-columns" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>We can rename columns two ways:</p>
<ol class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">.rename()</span></code> (to selectively change column names)</p></li>
<li><p>By setting the <code class="docutils literal notranslate"><span class="pre">.columns</span></code> attribute (to change all column names at once)</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Let’s give it a go:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Date&quot;</span><span class="p">:</span> <span class="s2">&quot;Datetime&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;Comments&quot;</span><span class="p">:</span> <span class="s2">&quot;Notes&quot;</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Wait? What happened? Nothing changed?</p></li>
<li><p>In the code above we did actually rename columns of our dataframe but we didn’t modify the dataframe inplace, we made a copy of it (more on that later)</p></li>
<li><p>There are generally two options for making permanent dataframe changes:</p>
<ul>
<li><ol class="simple">
<li><p>Use the argument <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">df.rename(...,</span> <span class="pre">inplace=True)</span></code>, available in most functions/methods</p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>Re-assign, e.g., <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">df.rename(...)</span></code></p></li>
</ol>
</li>
</ul>
</li>
<li><p>The Pandas team recommends <strong>Method 2 (re-assign)</strong>, for a <a class="reference external" href="https://www.youtube.com/watch?v=hK6o_TDXXN8&amp;t=700">few reasons</a> (mostly to do with how memory is allocated under the hood)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Date&quot;</span><span class="p">:</span> <span class="s2">&quot;Datetime&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Comments&quot;</span><span class="p">:</span> <span class="s2">&quot;Notes&quot;</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Datetime</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>If you wish to change all of the columns of a dataframe, you can do so by setting the <code class="docutils literal notranslate"><span class="pre">.columns</span></code> attribute</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="changing-the-index">
<h3>Changing the Index<a class="headerlink" href="#changing-the-index" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>You can change the index labels of a dataframe in 3 main ways:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.set_index()</span></code> to make one of the columns of the dataframe the index</p></li>
<li><p>Directly modify <code class="docutils literal notranslate"><span class="pre">df.index.name</span></code> to change the index name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> to move the current index as a column and to reset the index with integer labels starting from 0</p></li>
<li><p>Directly modify the <code class="docutils literal notranslate"><span class="pre">.index()</span></code> attribute</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Below I will set the index as <code class="docutils literal notranslate"><span class="pre">Column</span> <span class="pre">1</span></code> and rename the index to “New Index”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Column 1&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;New Index&quot;</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
    <tr>
      <th>New Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10 Sep 2019, 00:13:04</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>10 Sep 2019, 13:52:18</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>11 Sep 2019, 00:23:50</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>11 Sep 2019, 14:06:19</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>12 Sep 2019, 00:28:05</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4 Oct 2019, 01:08:08</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>9 Oct 2019, 13:55:40</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>10 Oct 2019, 00:10:31</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>10 Oct 2019, 13:47:14</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>11 Oct 2019, 00:16:57</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 5 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>I can send the index back to a column and have a default integer index using <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>New Index</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Like with column names, we can also modify the index directly, but I can’t remember ever doing this, usually I’ll use <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=33, step=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>New Index</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>101</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>102</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>103</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>104</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>128</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>129</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>130</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>131</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>132</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="adding-removing-columns">
<h3>Adding/Removing Columns<a class="headerlink" href="#adding-removing-columns" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There are two main ways to add/remove columns of a dataframe</p>
<ol class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">[]</span></code> to add columns</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.drop()</span></code> to drop columns</p></li>
</ol>
</li>
<li><p>Let’s re-read in a fresh copy of the cycling dataset</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cycling_data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>We can add a new column to a dataframe by simply using <code class="docutils literal notranslate"><span class="pre">[]</span></code> with a new column name and value(s)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Rider&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Tom Beuzen&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Avg Speed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>  <span class="c1"># avg. speed in m/s</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
      <th>Rider</th>
      <th>Avg Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
      <td>Tom Beuzen</td>
      <td>6.055662</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
      <td>Tom Beuzen</td>
      <td>5.148163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
      <td>Tom Beuzen</td>
      <td>6.720344</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
      <td>Tom Beuzen</td>
      <td>5.857664</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
      <td>Tom Beuzen</td>
      <td>6.599683</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
      <td>Tom Beuzen</td>
      <td>6.754011</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
      <td>Tom Beuzen</td>
      <td>5.909725</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
      <td>Tom Beuzen</td>
      <td>6.838675</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
      <td>Tom Beuzen</td>
      <td>5.192854</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
      <td>Tom Beuzen</td>
      <td>6.397179</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rider&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg Speed&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="adding-removing-rows">
<h3>Adding/Removing Rows<a class="headerlink" href="#adding-removing-rows" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>You won’t often be adding rows to a dataframe manually (you’ll usually add rows through concatenating/joining - that’s coming up next)</p></li>
<li><p>You can add/remove rows of a dataframe in two ways:</p>
<ol class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.append()</span></code> to add rows</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.drop()</span></code> to drop rows</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Let’s add a new row to the bottom of this dataframe</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">another_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;12 Oct 2019, 00:10:57&quot;</span><span class="p">,</span> <span class="s2">&quot;Morning Ride&quot;</span><span class="p">,</span> <span class="s2">&quot;Ride&quot;</span><span class="p">,</span>
                             <span class="mi">2331</span><span class="p">,</span> <span class="mf">12.67</span><span class="p">,</span> <span class="s2">&quot;Washed and oiled bike last night&quot;</span><span class="p">]],</span>
                           <span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">33</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">another_row</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
    <tr>
      <th>33</th>
      <td>12 Oct 2019, 00:10:57</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2331</td>
      <td>12.67</td>
      <td>Washed and oiled bike last night</td>
    </tr>
  </tbody>
</table>
<p>34 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>We can drop all rows above index 30 using <code class="docutils literal notranslate"><span class="pre">.drop()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">34</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2 Oct 2019, 13:46:06</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2134</td>
      <td>13.06</td>
      <td>Bit tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3 Oct 2019, 13:47:36</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2182</td>
      <td>12.68</td>
      <td>Wet road</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 6 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="dataframe-reshaping">
<h2>3. DataFrame Reshaping<a class="headerlink" href="#dataframe-reshaping" title="Permalink to this headline">¶</a></h2>
<hr><div class="section" id="tidy-data">
<h3>Tidy Data<a class="headerlink" href="#tidy-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://vita.had.co.nz/papers/tidy-data.pdf">Tidy data</a> is about “linking the structure of a dataset with its semantics (its meaning)”</p></li>
<li><p>You’ve already looked at tidy data in 523</p></li>
<li><p>It is defined by:</p>
<ol class="simple">
<li><p>Each variable forms a column</p></li>
<li><p>Each observation forms a row</p></li>
<li><p>Each type of observational unit forms a table</p></li>
</ol>
</li>
<li><p>Often you’ll need to reshape a dataframe to make it tidy (or for some other purpose)</p></li>
</ul>
<p><img alt="" src="../_images/tidy.png" /></p>
<p>Source: <a class="reference external" href="https://r4ds.had.co.nz/tidy-data.html#fig:tidy-structure">r4ds</a></p>
</div>
<div class="section" id="melt-and-pivot">
<h3>Melt and Pivot<a class="headerlink" href="#melt-and-pivot" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Pandas <code class="docutils literal notranslate"><span class="pre">.melt()</span></code>, <code class="docutils literal notranslate"><span class="pre">.pivot()</span></code> and <code class="docutils literal notranslate"><span class="pre">.pivot_table()</span></code> can help reshape dataframes</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.melt()</span></code>: make wide data long (like <code class="docutils literal notranslate"><span class="pre">melt()</span></code> in R)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pivot()</span></code>: make long data width (like <code class="docutils literal notranslate"><span class="pre">cast()</span></code> in R)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pivot_table()</span></code>: same as <code class="docutils literal notranslate"><span class="pre">.pivot()</span></code> but can handle multiple indexes</p></li>
</ul>
</li>
</ul>
<p><img alt="" src="../_images/melt_pivot.gif" /></p>
<p>Source: <a class="reference external" href="https://github.com/gadenbuie/tidyexplain#spread-and-gather">Garrick Aden-Buie’s GitHub</a></p>
<ul class="simple">
<li><p>The below data shows how many courses different instructors taught across different years</p></li>
<li><p>If the question you want to answer is something like: “Does the number of courses taught vary depending on year?” then the below would probably not be considered tidy because there are multiple observations of courses taught in a year per row (i.e., there is data for 2018, 2019 and 2020 in a single row):</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">,</span> <span class="s2">&quot;Tiffany&quot;</span><span class="p">,</span> <span class="s2">&quot;Varada&quot;</span><span class="p">,</span> <span class="s2">&quot;Joel&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                   <span class="s2">&quot;2019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="s2">&quot;2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Let’s make it tidy with <code class="docutils literal notranslate"><span class="pre">.melt()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.melt()</span></code> takes a few arguments, most important is the <code class="docutils literal notranslate"><span class="pre">id_vars</span></code> which indicated which column should be the “identifier”</p></li>
<li><p>I often think of Tidy data as “<em>you should only have to ask one question to extract all the information from a row</em>”: e.g., “How many courses did Tom teach in 2019?”, in the table above you would have needed to ask 3 questions to get all the information from a row: “How many courses did Tom teach in 2018?”, “How many courses did Tom teach in 2019?”, “How many courses did Tom teach in 2020?”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_melt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                  <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                  <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>
<span class="n">df_melt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>2018</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>2018</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tiffany</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Varada</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Joel</td>
      <td>2019</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Tom</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mike</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Tiffany</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Varada</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Joel</td>
      <td>2020</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">value_vars</span></code> argument allows us to select which specific variables we want to “melt” (if you don’t specify <code class="docutils literal notranslate"><span class="pre">value_vars</span></code>, all non-identifier columns will be used)</p></li>
<li><p>For example, below I’m omitting the <code class="docutils literal notranslate"><span class="pre">2018</span></code> column:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2019&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">],</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>2019</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tiffany</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Varada</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Joel</td>
      <td>2020</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Sometimes, you want to make long data wide, which we can do with <code class="docutils literal notranslate"><span class="pre">.pivot()</span></code></p></li>
<li><p>When using <code class="docutils literal notranslate"><span class="pre">.pivot()</span></code> we need to specify the <code class="docutils literal notranslate"><span class="pre">index</span></code> to pivot on, and the <code class="docutils literal notranslate"><span class="pre">columns</span></code> that will be used to make the new columns of the wider dataframe:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_melt</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                         <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>
<span class="n">df_pivot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Joel</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Mike</th>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Tiffany</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Varada</th>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>You’ll notice that Pandas set our specified <code class="docutils literal notranslate"><span class="pre">index</span></code> as the index of the new dataframe and preserved the label of the columns</p></li>
<li><p>We can easily remove these names and reset the index to make our dataframe look like it originally did</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_pivot</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_pivot</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">df_pivot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Joel</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Varada</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.pivot()</span></code> will often get you what you want, but it won’t work if you want to:</p>
<ul>
<li><p>Use multiple indexes (next lecture)</p></li>
<li><p>Have duplicate index/column labels</p></li>
</ul>
</li>
<li><p>In these cases you’ll have to use <code class="docutils literal notranslate"><span class="pre">.pivot_table()</span></code></p></li>
<li><p>I won’t focus on it too much here because I’d rather you learn about <code class="docutils literal notranslate"><span class="pre">pivot()</span></code> first</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;Department&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CS&quot;</span><span class="p">,</span> <span class="s2">&quot;STATS&quot;</span><span class="p">,</span> <span class="s2">&quot;CS&quot;</span><span class="p">,</span> <span class="s2">&quot;STATS&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="s2">&quot;2019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="s2">&quot;2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Department&quot;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Department</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2018</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2020</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2020</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>In the above case, we have duplicates in <code class="docutils literal notranslate"><span class="pre">Name</span></code>, so <code class="docutils literal notranslate"><span class="pre">pivot()</span></code> won’t work</p></li>
<li><p>It will throw us a <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">Index</span> <span class="pre">contains</span> <span class="pre">duplicate</span> <span class="pre">entries,</span> <span class="pre">cannot</span> <span class="pre">reshape</span></code>:</p></li>
</ul>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
         <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
         <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">41</span><span class="o">-</span><span class="mf">585e29950052</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>          <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
<span class="ne">----&gt; </span><span class="mi">3</span>          <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Courses&quot;</span><span class="p">)</span>

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ni">pivot</span><span class="nt">(self, index, columns, values)</span>
<span class="g g-Whitespace">   </span><span class="mi">6665</span>         <span class="kn">from</span> <span class="nn">pandas.core.reshape.pivot</span> <span class="kn">import</span> <span class="n">pivot</span>
<span class="g g-Whitespace">   </span><span class="mi">6666</span> 
<span class="ne">-&gt; </span><span class="mi">6667</span>         <span class="k">return</span> <span class="n">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6668</span> 
<span class="g g-Whitespace">   </span><span class="mi">6669</span>     <span class="n">_shared_docs</span><span class="p">[</span>

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/reshape/pivot.py</span> in <span class="ni">pivot</span><span class="nt">(data, index, columns, values)</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">476</span>             <span class="n">indexed</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_constructor_sliced</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">477</span>     <span class="k">return</span> <span class="n">indexed</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span> 
<span class="g g-Whitespace">    </span><span class="mi">479</span> 

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/series.py</span> in <span class="ni">unstack</span><span class="nt">(self, level, fill_value)</span>
<span class="g g-Whitespace">   </span><span class="mi">3888</span>         <span class="kn">from</span> <span class="nn">pandas.core.reshape.reshape</span> <span class="kn">import</span> <span class="n">unstack</span>
<span class="g g-Whitespace">   </span><span class="mi">3889</span> 
<span class="ne">-&gt; </span><span class="mi">3890</span>         <span class="k">return</span> <span class="n">unstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3891</span> 
<span class="g g-Whitespace">   </span><span class="mi">3892</span>     <span class="c1"># ----------------------------------------------------------------------</span>

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ni">unstack</span><span class="nt">(obj, level, fill_value)</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span>             <span class="k">return</span> <span class="n">_unstack_extension_series</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span>         <span class="n">unstacker</span> <span class="o">=</span> <span class="n">_Unstacker</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">425</span>             <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">constructor</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">_constructor_expanddim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span>         <span class="k">return</span> <span class="n">unstacker</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span>

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ni">__init__</span><span class="nt">(self, index, level, constructor)</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unstacked DataFrame is too big, causing int32 overflow&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> 
<span class="ne">--&gt; </span><span class="mi">120</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_make_selectors</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span> 
<span class="g g-Whitespace">    </span><span class="mi">122</span>     <span class="nd">@cache_readonly</span>

<span class="nn">/opt/miniconda3/envs/mds511/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ni">_make_selectors</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span> 
<span class="g g-Whitespace">    </span><span class="mi">168</span>         <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">169</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index contains duplicate entries, cannot reshape&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span> 
<span class="g g-Whitespace">    </span><span class="mi">171</span>         <span class="bp">self</span><span class="o">.</span><span class="n">group_index</span> <span class="o">=</span> <span class="n">comp_index</span>

<span class="ne">ValueError</span>: Index contains duplicate entries, cannot reshape
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>In such a case, we’d use <code class="docutils literal notranslate"><span class="pre">.pivot_table()</span></code></p></li>
<li><p>It will apply an aggregation function to our duplicates, in this case, we’ll <code class="docutils literal notranslate"><span class="pre">sum()</span></code> them up:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Courses&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mike</th>
      <td>4</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>3</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>If we wanted to keep the numbers per department, we could specify both <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Department</span></code> as multiple indexes:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Department&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Courses&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Department</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Mike</th>
      <th>CS</th>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>STATS</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Tom</th>
      <th>CS</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>STATS</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The result above is a mutlti-index or “hierarchically indexed” dataframe (more on those next lecture)</p></li>
<li><p>If you ever have a need to use it, you can read more about <code class="docutils literal notranslate"><span class="pre">pivot_table()</span></code> in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#pivot-tables">documentation</a></p></li>
</ul>
</div>
</div>
<div class="section" id="working-with-multiple-dataframes">
<h2>4. Working with Multiple DataFrames<a class="headerlink" href="#working-with-multiple-dataframes" title="Permalink to this headline">¶</a></h2>
<hr><ul class="simple">
<li><p>Often you’ll work with multiple dataframes that you want to stick together or merge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.merge()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.concat()</span></code> are all you need to know for combining dataframes</p></li>
<li><p>The Pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">documentation</a> is very helpful for these functions, but they are pretty easy to grasp</p></li>
</ul>
<div class="section" id="sticking-dataframes-together-with-pd-concat">
<h3>Sticking DataFrames Together with <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code><a class="headerlink" href="#sticking-dataframes-together-with-pd-concat" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>You can use <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> to stick dataframes together:</p>
<ul>
<li><p>Vertically: if they have the same <strong>columns</strong>, OR</p></li>
<li><p>Horizontally: if they have the same <strong>rows</strong></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># axis=0 specifies a vertical stick, i.e., on the columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Notice that the indexes were simply joined together? This may or may not be what you want</p></li>
<li><p>To reset the index, you can specify the argument <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> to stick together horizontally</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>You are not limited to just two dataframes, you can concatenate as many as you want</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>11</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="joining-dataframes-with-pd-merge">
<h3>Joining DataFrames with <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code><a class="headerlink" href="#joining-dataframes-with-pd-merge" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> is analagous to the “joining” operations you looked at in R</p></li>
<li><p>Mergining is more like SQL (if you’re familiar with it)</p></li>
<li><p>You can use <code class="docutils literal notranslate"><span class="pre">df.merge()</span></code> to join dataframes based on shared <code class="docutils literal notranslate"><span class="pre">key</span></code> columns</p></li>
<li><p>methods include:</p>
<ul>
<li><p>“inner join”</p></li>
<li><p>“outer join”</p></li>
<li><p>“left join”</p></li>
<li><p>“right join”</p></li>
</ul>
</li>
<li><p>See this great <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/comparison/comparison_with_sql.html#compare-with-sql-join">cheat sheet</a> and <a class="reference external" href="https://github.com/gadenbuie/tidyexplain">these great animations</a> for more insights</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Magneto&#39;</span><span class="p">,</span> <span class="s1">&#39;Storm&#39;</span><span class="p">,</span> <span class="s1">&#39;Mystique&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">,</span> <span class="s1">&#39;Catwoman&#39;</span><span class="p">,</span> <span class="s1">&#39;Hellboy&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;alignment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bad&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="s1">&#39;bad&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="s1">&#39;bad&#39;</span><span class="p">,</span> <span class="s1">&#39;bad&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;publisher&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Marvel&#39;</span><span class="p">,</span> <span class="s1">&#39;Marvel&#39;</span><span class="p">,</span> <span class="s1">&#39;Marvel&#39;</span><span class="p">,</span> <span class="s1">&#39;DC&#39;</span><span class="p">,</span> <span class="s1">&#39;DC&#39;</span><span class="p">,</span> <span class="s1">&#39;DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Dark Horse Comics&#39;</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;publisher&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Marvel&#39;</span><span class="p">,</span> <span class="s1">&#39;Image&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;year_founded&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1934</span><span class="p">,</span> <span class="mi">1939</span><span class="p">,</span> <span class="mi">1992</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/join.png" /></p>
<ul class="simple">
<li><p>An “inner” join will return all rows of <code class="docutils literal notranslate"><span class="pre">df1</span></code> where matching values for “publisher” are found in <code class="docutils literal notranslate"><span class="pre">df2</span></code>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;publisher&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><img alt="" src="../_images/inner_join.png" /></p>
<ul class="simple">
<li><p>An “outer” join will return all rows of <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code>, placing NaNs where information is unavailble</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;publisher&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><img alt="" src="../_images/outer_join.png" /></p>
<ul class="simple">
<li><p>Return all rows from <code class="docutils literal notranslate"><span class="pre">df1</span></code> and all columns of <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code>, populated where matches occur</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;publisher&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><img alt="" src="../_images/left_join.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;publisher&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>There are many ways to specify the <code class="docutils literal notranslate"><span class="pre">key</span></code> to join dataframes on, you can join on index values, different, column names, etc</p></li>
<li><p>Another helpful argument is the <code class="docutils literal notranslate"><span class="pre">indicator</span></code> argument which will add a column to the result telling you where matches were found in the dataframes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;publisher&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992.0</td>
      <td>right_only</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>By the way, you can use <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> to do a simple “inner” or “outer” join on multiple datadrames at once</p></li>
<li><p>It’s less flexible than merge, but can be useful sometimes (for example, in your lab this week!)</p></li>
</ul>
</div>
</div>
<div class="section" id="more-dataframe-operations">
<h2>5. More DataFrame Operations<a class="headerlink" href="#more-dataframe-operations" title="Permalink to this headline">¶</a></h2>
<hr><div class="section" id="applying-custom-functions">
<h3>Applying Custom Functions<a class="headerlink" href="#applying-custom-functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There will be times when you want to apply a function that is not built-in to Pandas</p></li>
<li><p>For this, we also have methods:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">df.apply()</span></code>, applies a function column-wise or row-wise across a dataframe (the function must be able to accept/return an array)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.applymap()</span></code>, applies a function element-wise (for functions that accept/return single values at a time)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">series.apply()</span></code>/<code class="docutils literal notranslate"><span class="pre">series.map()</span></code>, same as above but for Pandas series</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>For example, say you want to use a numpy function on a column in your dataframe</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cycling_data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Distance&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.901866</td>
      <td>0.053604</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.901697</td>
      <td>0.447197</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.035549</td>
      <td>-0.046354</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.739059</td>
      <td>0.270228</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.236515</td>
      <td>-0.086263</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-0.683372</td>
      <td>0.063586</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.150056</td>
      <td>0.133232</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.026702</td>
      <td>0.023627</td>
    </tr>
    <tr>
      <th>31</th>
      <td>-0.008640</td>
      <td>0.221770</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.897861</td>
      <td>-0.700695</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 2 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Or you may want to apply your own custom function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seconds_to_hours</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">seconds_to_hours</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.578889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.703056</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.517500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.608889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.525278</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.519444</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.596944</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.511389</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.684167</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.511944</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>This may have been better as a lambda function…</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.578889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.703056</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.517500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.608889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.525278</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.519444</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.596944</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.511389</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.684167</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.511944</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>You can even use functions that require additional arguments</p></li>
<li><p>Just specify the arguments in <code class="docutils literal notranslate"><span class="pre">.apply()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_seconds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;hours&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">to</span> <span class="o">==</span> <span class="s2">&quot;hours&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span>
    <span class="k">elif</span> <span class="n">to</span> <span class="o">==</span> <span class="s2">&quot;minutes&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">60</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_seconds</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.733333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>42.183333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31.050000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36.533333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31.516667</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>31.166667</td>
    </tr>
    <tr>
      <th>29</th>
      <td>35.816667</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30.683333</td>
    </tr>
    <tr>
      <th>31</th>
      <td>41.050000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>30.716667</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Some functions only accept/return a scalar</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="mf">3.141</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">([</span><span class="mf">3.141</span><span class="p">,</span> <span class="mf">10.345</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">62</span><span class="o">-</span><span class="mi">97</span><span class="n">f9c30c3ff1</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">float</span><span class="p">([</span><span class="mf">3.141</span><span class="p">,</span> <span class="mf">10.345</span><span class="p">])</span>

<span class="ne">TypeError</span>: float() argument must be a string or a number, not &#39;list&#39;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>For these, we need <code class="docutils literal notranslate"><span class="pre">.applymap()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2084</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1863</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2192</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1891</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2149</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1841</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2463</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1843</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>However, there are often “vectorized” versions of common functions like this already available, which are much faster</p></li>
<li><p>In the case above, we can use <code class="docutils literal notranslate"><span class="pre">.astype()</span></code> to change the dtype of a whole column quickly</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_applymap</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span>  -q -o -r 3 df[[&#39;Time&#39;]].applymap(float)
<span class="n">time_builtin</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span>  -q -o -r 3 df[[&#39;Time&#39;]].astype(float)
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;astype&#39; is </span><span class="si">{</span><span class="n">time_applymap</span><span class="o">.</span><span class="n">average</span> <span class="o">/</span> <span class="n">time_builtin</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> faster than &#39;applymap&#39;!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;astype&#39; is 1.91 faster than &#39;applymap&#39;!
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="grouping">
<h3>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Often we are interested in examining specific groups in our data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.groupby()</span></code> allows us to group our data based on a variable(s)</p></li>
<li><p>Analgous to the <code class="docutils literal notranslate"><span class="pre">group_by</span></code> function in R</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cycling_data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Let’s group this dataframe on the column <code class="docutils literal notranslate"><span class="pre">Name</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
<span class="n">dfg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x160bb3750&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>What is a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object?</p></li>
<li><p>It contains information about the groups of the dataframe</p></li>
</ul>
<p><img alt="" src="../_images/groupby_1.png" /></p>
<ul class="simple">
<li><p>The groupby object is really just a dictionary of index-mappings, which we could look at if we wanted to</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Afternoon Ride&#39;: [0, 2, 4, 6, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32], &#39;Morning Ride&#39;: [1, 3, 5, 7, 8, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31]}
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We can also access a group using the <code class="docutils literal notranslate"><span class="pre">.get_group()</span></code> method</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Afternoon Ride&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>12</th>
      <td>20 Sep 2019, 01:02:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2961</td>
      <td>12.81</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24 Sep 2019, 00:35:42</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2076</td>
      <td>12.47</td>
      <td>Oiled chain, bike feels smooth</td>
    </tr>
    <tr>
      <th>16</th>
      <td>25 Sep 2019, 00:07:21</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1775</td>
      <td>12.10</td>
      <td>Feeling really tired</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26 Sep 2019, 00:13:33</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1860</td>
      <td>12.52</td>
      <td>raining</td>
    </tr>
    <tr>
      <th>20</th>
      <td>27 Sep 2019, 01:00:18</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712</td>
      <td>12.47</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The usual thing to do however, is to apply aggregate functions to the groupby object</p></li>
</ul>
<p><img alt="" src="../_images/groupby_2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>4654.352941</td>
      <td>12.462</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2299.875000</td>
      <td>12.860</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>We can apply multiple functions using <code class="docutils literal notranslate"><span class="pre">.aggregate()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">Time</th>
      <th colspan="3" halign="left">Distance</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sum</th>
      <th>count</th>
      <th>mean</th>
      <th>sum</th>
      <th>count</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>4654.352941</td>
      <td>79124</td>
      <td>17</td>
      <td>12.462</td>
      <td>186.93</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2299.875000</td>
      <td>36798</td>
      <td>16</td>
      <td>12.860</td>
      <td>205.76</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>And even apply different functions to different columns</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">num_range</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">dfg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">({</span><span class="s2">&quot;Time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">num_range</span><span class="p">],</span> 
               <span class="s2">&quot;Distance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">Time</th>
      <th>Distance</th>
    </tr>
    <tr>
      <th></th>
      <th>max</th>
      <th>min</th>
      <th>mean</th>
      <th>num_range</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>48062</td>
      <td>1712</td>
      <td>4654.352941</td>
      <td>46350</td>
      <td>186.93</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2903</td>
      <td>2090</td>
      <td>2299.875000</td>
      <td>813</td>
      <td>205.76</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>By the way, you can use aggregate for non-grouped dataframes too</p></li>
<li><p>This is pretty much what <code class="docutils literal notranslate"><span class="pre">df.describe</span></code> does under-the-hood</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">num_range</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712.000000</td>
      <td>11.790000</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>count</th>
      <td>33</td>
      <td>33</td>
      <td>33</td>
      <td>33.000000</td>
      <td>31.000000</td>
      <td>33</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3512.787879</td>
      <td>12.667419</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>num_range</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46350.000000</td>
      <td>2.780000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="dealing-with-missing-values">
<h3>Dealing with Missing Values<a class="headerlink" href="#dealing-with-missing-values" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Missing values are typically denoted with <code class="docutils literal notranslate"><span class="pre">NaN</span></code></p></li>
<li><p>We can use <code class="docutils literal notranslate"><span class="pre">df.isnull()</span></code> to find missing values in a dataframe</p></li>
<li><p>It returns a boolean for each element in the dataframe</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>But it’s usually more helpful to get this information by row or by column using the <code class="docutils literal notranslate"><span class="pre">.any()</span></code> or <code class="docutils literal notranslate"><span class="pre">.info()</span></code> method</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 33 entries, 0 to 32
Data columns (total 6 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      33 non-null     object 
 1   Name      33 non-null     object 
 2   Type      33 non-null     object 
 3   Time      33 non-null     int64  
 4   Distance  31 non-null     float64
 5   Comments  33 non-null     object 
dtypes: float64(1), int64(1), object(4)
memory usage: 1.7+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>When you have missing values, we usually either drop them or impute them</p></li>
<li><p>You’ll learn more about imputing in 562/571/573</p></li>
<li><p>For now, you can drop missing values using <code class="docutils literal notranslate"><span class="pre">df.dropna()</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>31 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Or you can fill them using <code class="docutils literal notranslate"><span class="pre">.fillna()</span></code></p></li>
<li><p>This method has various options for filling, you can use a fixed value, the mean of the column, the previous non-nan value, etc</p></li>
<li><p>You’ll use this method more in the machine learning courses</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># fill with 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># fill with the mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span>  <span class="c1"># backward (upwards) fill from non-nan values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>  <span class="c1"># forward (downward) fill from non-nan values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Finally, sometimes I use visualizations to help identify (patterns in) missing values</p></li>
<li><p>One thing I often do is print a heatmap of my dataframe to get a feel for where my missing values are</p></li>
<li><p>If you want to run this code, you may need to install <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>:</p></li>
</ul>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>conda install seaborn
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/lecture7-wrangling-basics_191_0.png" src="../_images/lecture7-wrangling-basics_191_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a larger synthetic dataset for demonstration</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">npx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">npx</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">])</span>
<span class="n">npx</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">npx</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/lecture7-wrangling-basics_192_0.png" src="../_images/lecture7-wrangling-basics_192_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="lecture6-pandas.html" title="previous page">Lecture 6: Introduction to Pandas</a>
    <a class='right-next' id="next-link" href="lecture8-wrangling-advanced.html" title="next page">Lecture 8: Advanced Data Wrangling With Pandas</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tomas Beuzen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>